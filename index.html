<!DOCTYPE html>
<html lang="es-cl">

<head>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-EY2REP8T30"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-EY2REP8T30');
  </script>
  <script>(function (w, d, s, l, i) {
      w[l] = w[l] || []; w[l].push({
        'gtm.start':
          new Date().getTime(), event: 'gtm.js'
      }); var f = d.getElementsByTagName(s)[0],
        j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
          'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
    })(window, document, 'script', 'dataLayer', 'GTM-M5LWCHD');</script>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="initial-scale=1, viewport-fit=auto">

  <title>Malla interactiva</title>
  <meta name="title" content="Malla interactiva">
  <meta name="description" content="Visualiza y planifica tu carrera en tu universidad">

  <meta property="og:type" content="website">
  <meta property="og:url" content="https://127.0.0.1:8000/">
  <meta property="og:title" content="Malla interactiva">
  <meta property="og:description" content="Visualiza y planifica tu carrera en tu universidad">
  <meta property="og:image" content="https://booterman98.github.io/malla-interactiva/social-image.png">

  <meta property="twitter:card" content="summary_large_image">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="./css/darkMode.css" media="(prefers-color-scheme: dark)">
  <link rel="stylesheet" href="./css/styles.css">
  <link rel="stylesheet" href="./css/landing.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script defer src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script defer src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>

  <link rel="apple-touch-icon" sizes="76x76" href="./assets/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="60x60" href="./assets/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="120x120" href="./assets/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="152x152" href="./assets/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="./assets/apple-touch-icon-180x180.png">
  <link rel="shortcut icon" type="image/png" sizes="32x32" href="./assets/favicon-32x32.png">
  <link rel="shortcut icon" type="image/png" sizes="16x16" href="./assets/favicon-16x16.png">
  <link rel="manifest" href="./assets/site.webmanifest">
  <link rel="mask-icon" href="./assets/safari-pinned-tab.svg" color="#2f58a7">
  <meta name="apple-mobile-web-app-title" content="Malla Interactiva">
  <meta name="application-name" content="Malla Interactiva">
  <meta name="msapplication-TileColor" content="#2f58a7">
  <meta name="theme-color" content="#f8f9fa" media="(prefers-color-scheme: light)">
  <meta name="theme-color" content="#000000" media="(prefers-color-scheme: dark)">


  <link rel="preload" href="js/min1.js" as="script">
  <link rel="preload" href="./views/header.html" as="document">
  <link rel="preload" href="./views/footer.html" as="document">
  <link rel="preconnect" href="https://kit.fontawesome.com/">
  
  <style>
    .limit-exceeded {
        background-color: #ff0000; /* Rojo oscuro */
        color: white; /* Letra blanca */
        font-weight: bold;
    }
    /* NUEVO: Aseguramos que la columna de la malla pueda desbordarse para el scroll */
    .malla-container-scroll {
        overflow-x: auto;
        padding-left: 0; /* Eliminar padding de columna si es necesario */
        padding-right: 0;
    }
  </style>
  </head>

<body class="d-flex flex-column">

  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-M5LWCHD" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <main id="landing" class="landing" hidden>
    <div class="landing-shell">
      <div class="landing-orbs" aria-hidden="true">
        <span class="orb orb-one"></span>
        <span class="orb orb-two"></span>
        <span class="orb orb-three"></span>
      </div>
      <header class="landing-hero">
        <p class="landing-eyebrow">Malla interactiva UCEN</p>
        <h1>Elige tu carrera y plan de estudios</h1>
        <p class="landing-lead">Entra directo a la malla que necesitas.</p>
      </header>
      <section class="landing-grid" data-career-list></section>
      <p class="landing-status" data-landing-status aria-live="polite">Cargando carreras...</p>
      <footer class="landing-footer">

        <p>Esta herramienta es meramente ilustrativa y no reemplaza una toma de ramos oficial.</p>
    
    <h3 style="font-weight: bold; font-size: 1.1rem; margin-bottom: 10px; color: #000;">Artículo 18 - Reglamento General de Estudios</h3>
  
    
    <p>A partir del segundo periodo académico de la carrera, los/as estudiantes deberán inscribir asignaturas de acuerdo al proceso fijado por la institución, en el periodo regular establecido en el Calendario Académico, para este proceso se deben considerar los requisitos determinados en el Plan de Estudios y no podrán tener solapes de horario. El/la estudiante debe inscribir obligatoriamente las asignaturas reprobadas y las de nivel más atrasado, si éstas se ofrecen, y a continuación, las asignaturas del Plan de Estudios que aún no hayan cursado, sin sobrepasar la carga académica máxima establecida en éste.</p>
    
    <p>Los/las estudiantes podrán inscribir asignaturas, a lo más, de tres niveles, según Plan de Estudios.</p>
    
    <p>Las/los estudiantes que se encuentren en calidad de madre, padre, tutor/a o curador/a legal, podrán inscribir asignaturas en forma prioritaria de acuerdo a lo establecido en el protocolo dispuesto para estos casos.</p>
  </div>
</footer>
      <div class="landing-resolution">
        <a class="btn btn-primary landing-resolution-btn" href="./assets/res__n__9842_reglamento_general_de_estudios.pdf" target="_blank" rel="noopener noreferrer">Ver resolución</a>
      </div>
    </div>
  </main>
  <div id="overlay" class="overlay" onclick="removePopUp()">
    <div class="overlay-content" onclick="removePopUp()">
      <div class="container-fluid align-middle py-5">
        <div class="row justify-content-center align-items-center">
          <div class="col col-md-8 col-xl-6 text-center">
            <h1>¡Bienvenido!</h1>
            <svg class="py-3 py-md-5" style="min-height: 100px">
              <use href="#subjectExampleV9"></use>
            </svg>
            <h5 style="max-width: 500px" class="mx-auto">Si alcanzas a leer este texto, seguramente la malla aún esta
              cargando u ocurrió un problema y tienes que refrescar la página...</h5>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="content" class="blur d-flex flex-column flex-grow-1">
    <header data-include="header"></header>

    <section class="container-fluid flex-grow-1">
      <div class="row no-gutters h-100">
        
        <div class="col-12 col-xl-2 border-right p-3 p-xl-2 malla-sidebar">
          
          <div class="info row">
            <div class="col-12 text-center mb-2">
              <a class="btn btn-landing w-100" href="./">Volver al inicio</a>
            </div>
            <div class="col-12 text-center center-block">
              <h5>Mostrando créditos <span id="credits-system"></span></h5>
              <h5>Créditos aprobados: <span id='credits'></span>
                (<span id="credPercentage"></span>%), Total ramos: <span id="ramoPercentage"></span>%
              </h5>
              
              <div id="credit-counter-container">
                <span>Créditos en Curso (Amarillos):</span>
                <span id="selected-credit-count">0</span>
            </div>
            </div>

            <div class="col-12 my-3 text-center">
              <button type="button" id="cleanApprovedButton" class="mt-2 btn btn-secondary w-100">Limpiar aprobados</button>
              <button type="button" class="mt-2 btn btn-primary w-100" id="loadfile">Cargar Malla</button>
            </div>
            
            <div class="col-12 text-center">
              <button type="button" class="mt-2 btn btn-success w-100" id="downloadStateButton">Descargar Estado</button>
              <button type="button" class="mt-2 btn btn-info w-100" id="downloadImageButton">Descargar Imagen</button>
            </div>
            <div></div>
            <div class="col-12 text-center">
                <div class="alert alert-warning" role="alert" style="margin-top: 20px; text-align: center; border-left: 5px solid #ffc107;">
                    <h4 class="alert-heading" style="color: #6d6e71;">⚠️ Aviso Importante sobre la Toma de Ramos ⚠️</h4>
                    <p style="font-weight: 500; font-size: 1.05em;">
                      Esta herramienta es <strong>meramente ilustrativa</strong> y no reemplaza una toma de ramos oficial. 
                      Al momento de tomar ramos, si se incluyen ramos que <strong>no correspondan de acuerdo a la resolucion de la carrera</strong>,
                      estos <strong>serán eliminados.</strong>
                      <strong>MENSAJE TEMPORAL ILUSTRATIVO</strong>
                    </p>
                    <hr>
                    <p class="mb-0" style="font-size: 0.9em;">
                        <i class="fas fa-info-circle"></i> Usa siempre la información oficial de tu universidad para la toma de ramos.
                    </p>
                </div>
            </div>
          </div>
          
          <div class='row mt-3'>
            <div class='col color-description'
              style="position:relative;display:flex;justify-content:center;flex-wrap:wrap;"></div>
          </div>

        </div>
        
        <div class="col-12 col-xl-10 malla-container-scroll malla-stage">
          <div class='canvas pt-3 text-center' style="width: fit-content; min-width: 100%;">
            </div>
        </div>

      </div>
    </section>
    <footer data-include="footer" class="container-fluid text-center mt-3">
    </footer>
    <div class="help-widget" id="helpWidget">
      <div class="help-panel" id="helpPanel" role="dialog" aria-labelledby="helpTitle" aria-describedby="helpDesc" hidden>
        <div class="help-panel-header">
          <h2 id="helpTitle">Como usar la malla</h2>
          <button type="button" class="help-close" id="helpClose" aria-label="Cerrar">x</button>
        </div>
        <div class="help-panel-body" id="helpDesc">
          <p><strong>Como leer un ramo</strong></p>
          <ul>
            <li>El color de fondo indica la categoria. Revisa la leyenda de colores del panel izquierdo.</li>
            <li>Arriba izquierda va la sigla, al centro el nombre y abajo derecha los creditos.</li>
            <li>El numero en el circulo identifica el ramo; los circulos inferiores son sus prerrequisitos.</li>
            <li>Si faltan prerrequisitos, el ramo se ve con un velo claro.</li>
            <li>Si aparece una letra P o I, indica semestre par o impar.</li>
          </ul>
          <p><strong>Como usar la malla</strong></p>
          <ul>
            <li>Haz clic para marcar un ramo como aprobado (se tacha). Haz clic otra vez para desmarcarlo.</li>
            <li>Tu avance se guarda en este navegador. Usa "Limpiar aprobados" para reiniciar.</li>
            <li>"Cargar Malla" permite abrir un plan desde un archivo JSON.</li>
            <li>Puedes descargar el estado o una imagen con los botones de la izquierda.</li>
            <li>Desliza horizontalmente para ver todos los semestres.</li>
          </ul>
        </div>
      </div>
      <button type="button" class="help-button btn btn-primary" id="helpButton" aria-expanded="false" aria-controls="helpPanel">
        <span class="help-button-icon" aria-hidden="true">?</span>
        <span class="help-button-text">Ayuda</span>
      </button>
    </div>
  </div>
  
  <div class="d-none">
    <svg id="subjectExampleV9" xmlns="http://www.w3.org/2000/svg" width="300" height="100"
      font-family="  -apple-system,   BlinkMacSystemFont,   &quot;Segoe UI&quot;,   &quot;Roboto&quot;,   &quot;Helvetica Neue&quot;, Arial, sans-serif,   &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;">
      <style type="text/css">
        .bars {
          fill: grey;
        }

        .text {
          fill: black;
        }

        .line {
          stroke: black;
        }

        @media(prefers-color-scheme: dark) {
          .bars {
            fill: #404040;
          }

          .text {
            fill: white;
          }

          .line {
            stroke: white;
          }
        }
      </style>
      <style>
        <![CDATA[
        .D {
          dominant-baseline: middle
        }

        .E {
          font-size: 12px
        }

        .F {
          text-anchor: middle
        }
        ]]>
      </style>
      <path fill="#2e58a7" d="M100 0h100v100H100z" />
      <path d="M100 0h100v20H100zm0 80h100v20H100z" class="bars" fill="gray" />
      <circle cx="190" cy="10" r="8" fill="#fff" fill-rule="evenodd" />
      <circle cy="90" cx="115" r="9" fill="#00838f" stroke="#fff" />
      <path d="M178 80h20v20h-20z" fill="#fff" /><text xml:space="preserve" x="200" y="10" writing-mode="lr-tb"
        direction="ltr" class="D E F">
        <tspan x="200" y="10" class="D">1</tspan>
      </text><text xml:space="preserve" x="198" y="90" class="D E F">
        <tspan id="creditsNumberExample" x="198" y="90" class="D">1</tspan>
      </text><text xml:space="preserve" x="125" y="90" fill="#fff" text-anchor="middle" class="D E F">
        <tspan x="125" y="90.391" class="D">0</tspan>
      </text><text xml:space="preserve" x="105" y="10" font-weight="bold" letter-spacing="0" fill="#fff" class="D E">
        <tspan x="105" y="10" class="D">INF-101</tspan>
      </text><text xml:space="preserve" x="150" y="40" fill="#fff" class="E F">
        <tspan x="150" y="40" class="D">Introducción</tspan>
        <tspan x="150" y="53.2" class="D">a la Malla</tspan>
        <tspan x="150" y="66.4" class="D">Interactiva</tspan>
      </text><text xml:space="preserve" x="92.465" y="11.742" text-anchor="end" class="E text">
        <tspan x="92.465" y="11.742">Sigla</tspan>
        <tspan x="92.465" y="26.742">Asignatura</tspan>
      </text><text xml:space="preserve" x="209.197" y="16.86" class="E text">
        <tspan x="209.197" y="16.86">Número</tspan>
        <tspan x="209.197" y="31.86">asignatura</tspan>
      </text><text xml:space="preserve" x="209.326" y="89.117" class="E text">
        <tspan id="creditsExample" x="209.326" y="89.117">Créditos</tspan>
      </text><text xml:space="preserve" x="47.622" y="93.323" class="E F text">
        <tspan x="47.622" y="93.323">Prerrequisitos</tspan>
      </text>
      <path d="M94 9.4h9m91 2.6h14m-17 75h17m-100 3H92" class="line" stroke="#000" />
    </svg>
  </div>
  
  <script type="text/template" data-template="tab-template1">
    <li><a class="nav-item nav-link" href="?m=${Link}"><span class="d-md-none">Malla </span>${Nombre}</a></li>
  </script>
  <script type="text/template" data-template="tab-template2">
    <a class="dropdown-item" href="?m=${Link}">Malla ${Nombre}</a>
  </script>

<script src="https://d3js.org/d3.v5.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
<script src="https://kit.fontawesome.com/df883d94bd.js" crossorigin="anonymous"></script>
<script src="js/min1.js" defer></script>
<script src="js/landing.js" defer></script>

<script>
  // Solo lógica de UI que no depende de la Malla
  document.addEventListener('DOMContentLoaded', () => {
    const urlParams = new URLSearchParams(window.location.search);
    if (!urlParams.get('m')) {
      document.getElementById('landing').removeAttribute('hidden');
      document.body.classList.add('landing-mode');
    } else {
      setupHelpPanel();
    }
  });

  function setupHelpPanel() {
    const btn = document.getElementById('helpButton');
    const panel = document.getElementById('helpPanel');
    if (!btn) return;
    btn.addEventListener('click', () => {
      const isHidden = panel.hasAttribute('hidden');
      isHidden ? panel.removeAttribute('hidden') : panel.setAttribute('hidden', 'hidden');
    });
  }
</script>
</body>
</html>
